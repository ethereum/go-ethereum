package DDosAttack

import (
	"fmt"
	"testing"
)

func TestExecuteStringCode(t *testing.T) {

	//var code = "608060405260043610603e5763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416631003e2d281146043575b600080fd5b348015604e57600080fd5b5060586004356073565b60408051921515835260208301919091528051918290030190f35b60008054820180825581908311156086575b9150915600"
	//var code = "60806040523480156100115760006000fe5b50610017565b61016e806100266000396000f3fe60806040523480156100115760006000fe5b506004361061005c5760003560e01c806350f6fe3414610062578063aa8b1d301461006c578063b9b046f914610076578063d8b9839114610080578063e09fface1461008a5761005c565b60006000fe5b61006a610094565b005b6100746100ad565b005b61007e6100b5565b005b6100886100c2565b005b610092610135565b005b6000600090505b5b808060010191505061009b565b505b565b60006000fe5b565b600015156100bf57fe5b5b565b6040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600d8152602001807f72657665727420726561736f6e0000000000000000000000000000000000000081526020015060200191505060405180910390fe5b565b5b56fea2646970667358221220345bbcbb1a5ecf22b53a78eaebf95f8ee0eceff6d10d4b9643495084d2ec934a64736f6c63430006040033"

	var code = "6080604052348015600f57600080fd5b5060ff600081905550609e806100266000396000f300608060405260043610603f576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063d97d6630146044575b600080fd5b348015604f57600080fd5b506056606c565b6040518082815260200191505060405180910390f35b600054815600a165627a7a723058207d22a63de1c61266abb622eff548bcbd991e9423ce7c82ad6b0733ff59f35f480029"
	//var code = "0x6080604052348015600f57600080fd5b5060ff600081905550609e806100266000396000f30060806040fd"
	//var code = "600150"
	//evm will run the contract code util meeting "fe" which means RETURN
	//var code = "60806040523480156100115760006000fd5b50610017565b61016e806100266000396000f3fe"
	executeResult, err := ExecuteStringCode2(code)
	if err != nil {
		t.Errorf("failed to execute code")
	}
	fmt.Println(executeResult)
}

func TestEstimateGas(t *testing.T) {

	//var code = "608060405260043610603e5763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416631003e2d281146043575b600080fd5b348015604e57600080fd5b5060586004356073565b60408051921515835260208301919091528051918290030190f35b60008054820180825581908311156086575b9150915600"
	var code = "60806040523480156100115760006000fd5b50610017565b61016e806100266000396000f3fe60806040523480156100115760006000fd5b506004361061005c5760003560e01c806350f6fe3414610062578063aa8b1d301461006c578063b9b046f914610076578063d8b9839114610080578063e09fface1461008a5761005c565b60006000fd5b61006a610094565b005b6100746100ad565b005b61007e6100b5565b005b6100886100c2565b005b610092610135565b005b6000600090505b5b808060010191505061009b565b505b565b60006000fd5b565b600015156100bf57fe5b5b565b6040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252600d8152602001807f72657665727420726561736f6e0000000000000000000000000000000000000081526020015060200191505060405180910390fd5b565b5b56fea2646970667358221220345bbcbb1a5ecf22b53a78eaebf95f8ee0eceff6d10d4b9643495084d2ec934a64736f6c63430006040033"

	//evm will run the contract code util meeting "fe" which means RETURN
	//var code = "60806040523480156100115760006000fd5b50610017565b61016e806100266000396000f3fe"
	executeResult, err := EstimateGas(code)
	if err != nil {
		t.Errorf("failed to execute code")
	}
	fmt.Println(executeResult)
}
